from yacs.config import CfgNode as CN
from .utils import log_msg


def show_cfg(cfg):
    dump_cfg = CN()
    dump_cfg.EXPERIMENT = cfg.EXPERIMENT
    dump_cfg.DATA = cfg.DATA
    dump_cfg.DISTILLER = cfg.DISTILLER
    dump_cfg.SOLVER = cfg.SOLVER
    dump_cfg.LOG = cfg.LOG
    dump_cfg.DA = cfg.DA
    print(log_msg("CONFIG:\n{}".format(dump_cfg.dump()), "INFO"))


CFG = CN()

# Experiment
CFG.EXPERIMENT = CN()
CFG.EXPERIMENT.PROJECT = "distill"
CFG.EXPERIMENT.NAME = ""
CFG.EXPERIMENT.TAG = "default"
CFG.EXPERIMENT.DEVICE = "cuda"

# Distiller 

CFG.DISTILLER = CN()
CFG.DISTILLER.TYPE = "NONE"
CFG.DISTILLER.TEACHER = "dqn"
CFG.DISTILLER.STUDENT = "dqn"
CFG.DISTILLER.ENV = "BreakoutNoFrameskip-v4"

# Solver
CFG.SOLVER = CN()
CFG.SOLVER.TRAINER = "base"
CFG.SOLVER.BATCH_SIZE = 32
CFG.SOLVER.EPOCHS = 500
CFG.SOLVER.LR = 1e-4
CFG.SOLVER.LR_DECAY_STAGES = []
CFG.SOLVER.LR_DECAY_RATE = 0.1
CFG.SOLVER.WEIGHT_DECAY = 0.0001
CFG.SOLVER.MOMENTUM = 0.9
CFG.SOLVER.TYPE = "SGD"
CFG.SOLVER.SOFTMAX_TEMP = 0.01

# Data
CFG.DATA = CN()
CFG.DATA.MAX_CAPACITY = 540000
CFG.DATA.INCREMENT = True
CFG.DATA.INCREMENT_SIZE = 54000
CFG.DATA.EXPLORATION_RATE = 0.05


# Log
CFG.LOG = CN()
CFG.LOG.SAVE_CHECKPOINT_FREQ = 100
CFG.LOG.EVAL_FREQ = 1
CFG.LOG.EVAL_EPISODES = 5
CFG.LOG.FINAL_EVAL_EPS = 1000
CFG.LOG.PREFIX = "./output"
CFG.LOG.WANDB = True
CFG.LOG.BAR = True

# DA
CFG.DA = CN()
CFG.DA.LR = 0.01778
CFG.DA.EPOCHS = 1
CFG.DA.PROB = 0.7374